# 创建高级联结

- 使用表别名：
  - `SELECT Concat(RTrim(vend_name), ' (', RTrim(vend_country), ')') AS vend_title FROM vendors ORDER BY vend_name`
  - 别名除了用于列名和计算字段外，SQL还允许给表名起别名，
    - 缩短SQL语句
    - 允许在单挑SELECT语句中多次使用相同的表
  - `SELECT cust_name, cust_contact FROM custmers AS c, orders AS o, orderitems AS oi WHERE c.cust_id = o.cust_id AND oi.order_num = o.order_num AND prod_id = 'TNT2'`
- 使用不同类型的联结：我们现在使用的只是称为内部联结或等值联结的简单联结。还有其他3种联结，它们分别是自联结、自然联结和外部联结。
- 自联结
  - `SELECT prod_id, prod_name FROM products WHERE vend_id = (SELECT vend_id FROM products WHERE prod_id = 'DTNTR')`
  - `SELECT p1.prod_id, p1.prod_name FROM products AS p1, products AS p2 WHERE p1.vend_id = p2.vend_id AND p2.prod_id = 'DTNTR'`
- 自然联结：
  - `SELECT c.*, o.order_num, o.order_data, oi.prod_id, oi.quantity, oi.item_price FROM customers AS c, orders AS o, orderitems AS oi WHERE c.cust_id = o.cust_id AND oi.order_num = o.order_num AND prod_id = 'FB'`
- 外部联结：
  - `SELECT customers.cust_id, orders.order_num FROM customers INNER JOIN orders ON customers.cust_id = orders.cust_id`
  - `SELECT customers.cust_id, orders.order_num FROM customers LEFT OUTER JOIN orders ON customers.cust_id = orders.cust_id`
  - `SELECT customers.cust_id, orders.order_num FROM customers RIGHT OUTER JOIN orders ON orders.cust_id = customers.cust_id`
- 使用带聚集函数的联结
  - `SELECT customers.cust_name customers.cust_id, COUNT(orders.order_num) AS num_ord FROM customers INNER JOIN orders ON customers.cust_id = orders.cust_id GROUP BY customers.cust_id`
  - `SELECT customers.cust_name customers.cust_id, COUNT(orders.order_num) AS num_ord  FROM customers  LEFT OUTER JOIN orders ON  customers.cust_id = orders.cust_id GROUP BY customers.cust_id`
- 使用联结和联结条件
  - 注意所使用的联结类型。一般我们使用内部联结，但使用外部联结也是有效的。
  - 保证使用正确的联结条件，否则将返回不正确的数据
  - 应该总是提供联结条件，否则会得出笛卡尔积
  - 在一个联结中可以包含多个表，甚至对于每个联结可以采用不同的联结类型