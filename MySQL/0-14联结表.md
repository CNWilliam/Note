# 联结表

- 联结是利用SQL的SELECT能执行的最重要的操作。
- 关系表：
  - 因为同一供应商生产的每个产品的供应商信息都是相同的，对每个产品重复此信息既浪费时间又浪费存储空间。
  - 如果供应商信息改变(列如，供应商搬家或电话号码变动)，只需要改动一次即可
  - 很难保证每次输入数据的方式都相同。不一致的数据在报表中很难利用。
- 外键：外键为某个表中的一列，它包含另一个表的主键值，定义了两个表之间的关系
  - 这样做的好处：
    - 供应商信息不重复，从而不浪费时间和空间；
    - 如果供应商信息变动，可以只更新vendors表中的单个几率，相关表中的数据不用改动;
    - 由于数据无重复，显然数据是一致的，这使得处理数据更简单
- 可伸缩性：能够适应不断增加的工作量而不失败。设计良好的数据库或应用程序称之为*可伸缩性好*
- 为什么要是用联结：分解数据为多个表能更有效地存储，更方便地处理，并且具有更大的可伸缩性。但这些好处是有代价的
- 创建连接：
  - `SELECT vend_name, prod_name, prod_price FROM vendors, products WHERE vendors.vend_id = products.vend_id ORDER BY vend_name, prod_name;`
- 笛卡尔积：由没有联结条件的表关系返回的结果为笛卡尔积。检索出的行的数目将是第一个表中的行数乘以第二个表中的行数。
  - `SELECT vend_name, prod_name, prod_price FROM vendors, products ORDER BY vend_name, prod_name`
- 内部联结：
  - `SELECT vend_name, prod_name, prod_price FROM vendors INNER JOIN products ON vendors.vend_id = products.vend_id`
- 联结多个表：
  - `SELECT prod_name, vend_name, prod_price, quantity FROM orderitems, products, vendors WHERE products.vend_id = vendors.vend_id AND orderitems.prod_id = products.prod_id AND order_num = 20005`
  - `SELECT cust_name, cust_contact FROM customers WHERE cust_id IN (SELECT cust_id FROM orders WHERE order_num IN (SELECT order_num FROM orderitems WHERE prod_id = 'TNT2'))`
  - `SELECT cust_name, cust_contact FROM customers, orders, orderitems WHERE customers.cust_id = orders.cust_id AND orderitems.order_num = orders.order_num AND prod_id = 'TNT2'`
